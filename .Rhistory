source('C:/Users/babaj/Desktop/Code/CKD-Tessilk/CKD-Test.R')
areaUnderCurve <- performance(pred, "auc")@y.values
areaUnderCurve
View(ModelDataFactored)
source('C:/Users/babaj/Desktop/Code/CKD-Tessilk/CKD-Test.R')
ModelData <- read.csv("CKD Screening Data for Model Building.csv")
TestData <- read.csv("CKD Screening Data for Testing.csv")
ModelData$X <- NULL
TestData$X <- NULL
#Keep separate copy of datasets, start factorizing variables in new copies
ModelDataFactored <- ModelData
TestDataFactored <- TestData
source("Model-Factorize.R")
source("Test-Factorize.R")
ModelDataFactored <- na.omit(ModelDataFactored)
TestDataFactored <- na.omit(TestDataFactored)
TrainScaled <- as.data.frame(scale(ModelData))
nums <- sapply(ModelDataFactored, is.numeric)
ModelDataScaled <- as.data.frame(scale(ModelDataFactored[, nums]))
TestDataScaked <- as.data.frame(scale(TestDataFactored[, nums]))
KNN <- knn (ModelDataScaled, TestDataScaked, cl = ModelScaked$CKD, k = 3)
??knn
library(caret)
library(caTools)
library(ROCR)
source('C:/Users/babaj/Desktop/Code/CKD-Tessilk/CKD-Test.R')
KNN <- knn (ModelDataScaled, TestDataScaked, cl = ModelScaked$CKD, k = 3)
library(caret)
library(caTools)
library(ROCR)
KNN <- knn(ModelDataScaled, TestDataScaked, cl = ModelScaked$CKD, k = 3)
??knn
library(class)
KNN <- knn(ModelDataScaled, TestDataScaked, cl = ModelScaked$CKD, k = 3)
KNN <- knn(ModelDataScaled, TestDataScaked, cl = ModelScaled$CKD, k = 3)
KNN <- knn(ModelDataScaled, TestDataScaked, cl = ModelDataScaled$CKD, k = 3)
View(TestDataScaked)
KNN <- knn(ModelDataScaled, TestDataScaked, cl = ModelDataScaled$CKD, k = 3)
ModelDataScaled <- na.omit(ModelDataScaled)
TestDataScaked <- na.omit(TestDataScaked)
KNN <- knn(ModelDataScaled, TestDataScaked, cl = ModelDataScaled$CKD, k = 3)
KNN <- knn(ModelDataScaled, TestDataScaked, cl = ModelDataFactored$CKD, k = 3)
knnFit <- train(CKD~., data = ModelDataScaled, method = "knn", trControl = ctrl, tuneLength = 20)
knnFit <- train(CKD~., data = ModelDataFactored, method = "knn", trControl = ctrl, tuneLength = 20)
ctrl <- trainControl(method = "repeatedcv", number = 3, repeats = 3)
knnFit <- train(CKD~., data = ModelDataFactored, method = "knn", trControl = ctrl, tuneLength = 20)
ModelDataScaled <- ModelDataFactored
TestDataScaked <- TestDataFactored
ModelDataScaled[, nums] <- as.data.frame(scale(ModelDataFactored[, nums]))
TestDataScaked[, nums] <- as.data.frame(scale(TestDataFactored[, nums]))
View(TestDataScaked)
ModelDataScaled <- na.omit(ModelDataScaled)
TestDataScaked <- na.omit(TestDataScaked)
KNN <- knn(ModelDataScaled, TestDataScaked, cl = ModelDataFactored$CKD, k = 3)
KNN <- knn(ModelDataScaled, TestDataScaked, cl = ModelDataScaled$CKD, k = 3)
View(ModelDataScaled)
, nums
ModelDataScaled <- ModelDataFactored
TestDataScaked <- TestDataFactored
nums <- sapply(ModelDataFactored, is.numeric)
ModelDataScaled[, nums] <- as.data.frame(scale(ModelDataFactored[, nums]))
TestDataScaked[, nums] <- as.data.frame(scale(TestDataFactored[, nums]))
ModelDataScaled <- na.omit(ModelDataScaled)
TestDataScaked <- na.omit(TestDataScaked)
KNN <- knn(ModelDataScaled, TestDataScaked, cl = ModelDataScaled$CKD, k = 3)
View(ModelDataScaled)
View(TestDataScaked)
View(TestData)
ModelData <- read.csv("CKD Screening Data for Model Building.csv")
TestData <- read.csv("CKD Screening Data for Testing.csv")
ModelData$ID <- NULL
TestData$ID <- NULL
View(ModelData)
ModelData$X <- NULL
TestData$X <- NULL
ModelDataFactored <- ModelData
TestDataFactored <- TestData
source("Model-Factorize.R")
source("Test-Factorize.R")
ModelDataFactored <- na.omit(ModelDataFactored)
TestDataFactored <- na.omit(TestDataFactored)
ModelDataScaled <- ModelDataFactored
TestDataScaked <- TestDataFactored
nums <- sapply(ModelDataFactored, is.numeric)
ModelDataScaled[, nums] <- as.data.frame(scale(ModelDataFactored[, nums]))
TestDataScaked[, nums] <- as.data.frame(scale(TestDataFactored[, nums]))
ModelDataScaled <- na.omit(ModelDataScaled)
TestDataScaked <- na.omit(TestDataScaked)
KNN <- knn(ModelDataScaled, TestDataScaked, cl = ModelDataScaled$CKD, k = 3)
length(cl)
length(ModelDataScaled$CKD)
dim(ModelDataScaled)
dim(TestDataScaled)
dim(ModelDataScaked)
dim(TestDataScaked)
training <- NULL
testing <- NULL
TestDataScaked <- NULL
index <- createDataPartition(ModelDataFactored$CKD, p = 0.75, list = FALSE)
training <- ModelDataScaled[index,]
testing <- ModelDataScaled[-index,]
KNN <- knn(training, testing, cl = training$CKD, k = 3)
View(testing)
ModelDataScaled <- ModelData
nums <- sapply(ModelDataFactored, is.numeric)
ModelDataScaled[, nums] <- as.data.frame(scale(ModelDataFactored[, nums]))
index <- createDataPartition(ModelDataFactored$CKD, p = 0.75, list = FALSE)
training <- ModelDataScaled[index,]
testing <- ModelDataScaled[-index,]
ModelDataScaled <- ModelData
nums <- sapply(ModelDataFactored, is.numeric)
ModelDataScaled[, nums] <- as.data.frame(scale(ModelDataFactored[, nums]))
ModelDataScaled[, nums] <- as.data.frame(scale(ModelData[, nums]))
index <- createDataPartition(ModelDataFactored$CKD, p = 0.75, list = FALSE)
training <- ModelDataScaled[index,]
testing <- ModelDataScaled[-index,]
KNN <- knn(training, testing, cl = training$CKD, k = 3)
View(ModelDataScaled)
ModelDataScaled <- na.omit(ModelDataScaled)
nums <- sapply(ModelDataFactored, is.numeric)
ModelDataScaled[, nums] <- as.data.frame(scale(ModelData[, nums]))
ModelDataScaled <- ModelData
ModelDataScaled <- na.omit(ModelDataScaled)
nums <- sapply(ModelDataFactored, is.numeric)
ModelDataScaled[, nums] <- as.data.frame(scale(ModelData[, nums]))
warnings()
index <- createDataPartition(ModelDataFactored$CKD, p = 0.75, list = FALSE)
training <- ModelDataScaled[index,]
testing <- ModelDataScaled[-index,]
KNN <- knn(training, testing, cl = training$CKD, k = 3)
View(ModelData)
ModelDataScaled[, nums] <- as.data.frame(scale(ModelData[, nums]))
ModelData <- na.omit(ModelData)
ModelDataScaled <- ModelData
nums <- sapply(ModelDataFactored, is.numeric)
ModelDataScaled[, nums] <- as.data.frame(scale(ModelData[, nums]))
index <- createDataPartition(ModelDataFactored$CKD, p = 0.75, list = FALSE)
training <- ModelDataScaled[index,]
testing <- ModelDataScaled[-index,]
KNN <- knn(training, testing, cl = training$CKD, k = 3)
View(ModelData)
ModelDataScaled <- as.data.frame(scale(ModelData[, nums]))
index <- createDataPartition(ModelDataFactored$CKD, p = 0.75, list = FALSE)
training <- ModelDataScaled[index,]
testing <- ModelDataScaled[-index,]
KNN <- knn(training, testing, cl = training$CKD, k = 3)
View(ModelDataScaled)
ModelDataScaled$CKD = ModelData$CKD
index <- createDataPartition(ModelDataFactored$CKD, p = 0.75, list = FALSE)
training <- ModelDataScaled[index,]
testing <- ModelDataScaled[-index,]
KNN <- knn(training, testing, cl = training$CKD, k = 3)
#Now let's try finding the best k
ctrl <- trainControl(method = "repeatedcv", number = 3, repeats = 3)
knnFit <- train(CKD~., data = ModelDataFactored, method = "knn", trControl = ctrl, tuneLength = 20)
knnFit
KNN-Final <- knn(training, testing, cl = training$CKD, k = 19)
KNN_Final <- knn(training, testing, cl = training$CKD, k = 19)
table(testing$CKD, KNN_Final)
plot(KNN_Final)
confusionMatrix(knnFinal, testing$CKD)
confusionMatrix(KNN_Final, testing$CKD)
knnFit <- train(CKD~., data = training, method = "knn", trControl = ctrl, tuneLength = 20)
ModelDataScaled$CKD = factor(ModelData$CKD, labels = c("Yes", "No"), levels = c(1, 0))
index <- createDataPartition(ModelDataFactored$CKD, p = 0.75, list = FALSE)
training <- ModelDataScaled[index,]
testing <- ModelDataScaled[-index,]
KNN <- knn(training, testing, cl = training$CKD, k = 3)
ctrl <- trainControl(method = "repeatedcv", number = 3, repeats = 3)
knnFit <- train(CKD~., data = training, method = "knn", trControl = ctrl, tuneLength = 20)
ModelDataScaled < - <- sapply(ModelDataFactored, as.numeric)
ModelDataScaled <- sapply(ModelDataFactored, as.numeric)
View(ModelDataScaled)
ModelDataScaled <- as.data.frame(scale(ModelDataScaled))
index <- createDataPartition(ModelDataFactored$CKD, p = 0.75, list = FALSE)
training <- ModelDataScaled[index,]
testing <- ModelDataScaled[-index,]
KNN <- knn(training, testing, cl = training$CKD, k = 3)
ctrl <- trainControl(method = "repeatedcv", number = 3, repeats = 3)
knnFit <- train(CKD~., data = training, method = "knn", trControl = ctrl, tuneLength = 20)
knnFit
KNN_Final <- knn(training, testing, cl = training$CKD, k = 19)
table(testing$CKD, KNN_Final)
confusionMatrix(KNN_Final, testing$CKD)
